<script>
  import atomOneLight from "svelte-highlight/styles/atom-one-light";
	import Sidebar from "./Sidebar.svelte";
	import { base } from '$app/paths';
  import { page } from '$app/stores';
  import { afterNavigate } from '$app/navigation';
	import './styles.css';

	let isOpen = true;
	afterNavigate(() => {
		const contentwidth = parseInt(getComputedStyle(document.body).getPropertyValue('--max-width'), 10);
		const sidebarwidth = parseInt(getComputedStyle(document.body).getPropertyValue('--sidebar-width'), 10);
		const totalwidth = contentwidth + sidebarwidth;
		isOpen = window.matchMedia('(min-width:'+totalwidth+'px)').matches;
  });

	const navItems = [
    { href: base+'/', label: 'Code Vis', path: "M9 14h6.5q1.05 0 1.775-.737T18 11.474T17.25 9.7t-1.8-.725q-.2-1.275-1.175-2.125T12 6q-1.025 0-1.875.55T8.85 8.025q-1.2.05-2.025.913T6 11q0 1.25.875 2.125T9 14m0-2q-.425 0-.712-.288T8 11t.288-.712T9 10h1.25v-.25q0-.725.513-1.237T12 8t1.238.513t.512 1.237V11h1.75q.2 0 .35.15t.15.35t-.15.35t-.35.15zm1 7v-2H4q-.825 0-1.412-.587T2 15V5q0-.825.588-1.412T4 3h16q.825 0 1.413.588T22 5v10q0 .825-.587 1.413T20 17h-6v2h1q.425 0 .713.288T16 20t-.288.713T15 21H9q-.425 0-.712-.288T8 20t.288-.712T9 19zm-6-4h16V5H4zm0 0V5z" },
	{ href: base+'/html', label: 'HTML', path: "M0 14.25v-4.5q0-.325.213-.537T.75 9t.538.213t.212.537V11h2V9.75q0-.325.213-.537T4.25 9t.538.213T5 9.75v4.5q0 .325-.213.538T4.25 15t-.537-.213t-.213-.537V12.5h-2v1.75q0 .325-.213.538T.75 15t-.537-.213T0 14.25m7.75 0V10.5h-1q-.325 0-.537-.213T6 9.75t.213-.537T6.75 9h3.5q.325 0 .538.213T11 9.75t-.213.538t-.537.212h-1v3.75q0 .325-.213.538T8.5 15t-.537-.213t-.213-.537m4.25 0V10q0-.425.288-.712T13 9h4.5q.425 0 .713.288T18.5 10v4.25q0 .325-.213.538T17.75 15t-.537-.213T17 14.25V10.5h-1v2.75q0 .325-.213.538T15.25 14t-.537-.213t-.213-.537V10.5h-1v3.75q0 .325-.213.538T12.75 15t-.537-.213T12 14.25m8.75.75q-.325 0-.537-.213T20 14.25v-4.5q0-.325.213-.537T20.75 9t.538.213t.212.537v3.75h1.75q.325 0 .538.213t.212.537t-.213.538t-.537.212z"},
    { href: base+'/css', label: 'CSS', path: "M13 13.5v-1h-2.5q-.425 0-.712-.288T9.5 11.5V10q0-.425.288-.712T10.5 9h3.25q.325 0 .538.213t.212.537t-.213.538t-.537.212H11v1h2.5q.425 0 .713.288t.287.712V14q0 .425-.288.713T13.5 15h-3.25q-.325 0-.537-.213T9.5 14.25t.213-.537t.537-.213zm6.5 0v-1H17q-.425 0-.712-.288T16 11.5V10q0-.425.288-.712T17 9h3.25q.325 0 .538.213T21 9.75t-.213.538t-.537.212H17.5v1H20q.425 0 .713.288T21 12.5V14q0 .425-.288.713T20 15h-3.25q-.325 0-.537-.213T16 14.25t.213-.537t.537-.213zM4 15q-.425 0-.712-.288T3 14v-4q0-.425.288-.712T4 9h3q.425 0 .713.288T8 10v.525q0 .3-.225.513t-.525.212q-.325 0-.537-.213T6.5 10.5h-2v3h2q0-.3.213-.525t.537-.225q.3 0 .525.225T8 13.5v.5q0 .425-.288.713T7 15z" },
    { href: base+'/javascript', label: 'JavaScript', path: "M7.5 15q-.625 0-1.062-.437T6 13.5v-.25q0-.325.213-.537t.537-.213t.538.213t.212.537v.25H9V9.75q0-.325.213-.537T9.75 9t.538.213t.212.537v3.75q0 .625-.437 1.063T9 15zm5.5 0q-.425 0-.712-.288T12 14v-.5q0-.2.15-.35t.35-.15h.5q.2 0 .35.15t.15.35h2v-1H13q-.425 0-.712-.288T12 11.5V10q0-.425.288-.712T13 9h3q.425 0 .713.288T17 10v.5q0 .2-.15.35t-.35.15H16q-.2 0-.35-.15t-.15-.35h-2v1H16q.425 0 .713.288T17 12.5V14q0 .425-.288.713T16 15z"},
    { href: base+'/svg', label: 'SVG', path: "M7 18q-1.65 0-2.825-1.175Q3 15.65 3 14q0-1.65 1.175-2.825Q5.35 10 7 10q1.65 0 2.825 1.175Q11 12.35 11 14q0 1.65-1.175 2.825Q8.65 18 7 18Zm9.5-4q-2.3 0-3.9-1.6T11 8.5q0-2.3 1.6-3.9T16.5 3q2.3 0 3.9 1.6T22 8.5q0 2.3-1.6 3.9T16.5 14Zm-2 7q-1.25 0-2.125-.875T11.5 18q0-1.25.875-2.125T14.5 15q1.25 0 2.125.875T17.5 18q0 1.25-.875 2.125T14.5 21Zm2-9q1.475 0 2.488-1.012Q20 9.975 20 8.5t-1.012-2.488Q17.975 5 16.5 5t-2.488 1.012Q13 7.025 13 8.5t1.012 2.488Q15.025 12 16.5 12Zm-2 7q.425 0 .713-.288q.287-.287.287-.712t-.287-.712Q14.925 17 14.5 17t-.712.288q-.288.287-.288.712t.288.712q.287.288.712.288Zm2-10.5Zm-2 9.5Z" },
	{ href: base+'/svelte', label: 'Svelte', path: "M18.7148 3.1836C16.4922-.0078 12.0703-.9414 8.8906 1.0703L3.2813 4.6445C1.7539 5.6016.6914 7.1641.3867 8.9336c-.2656 1.4805-.039 3.0039.6719 4.3242-.4883.7344-.8125 1.5469-.957 2.3985-.3243 1.8085.1015 3.6796 1.164 5.1601 2.2422 3.1914 6.6446 4.125 9.8242 2.1133l5.6055-3.5547c1.5313-.9531 2.5899-2.5195 2.8985-4.2852.2617-1.4843.039-3.0078-.6758-4.3281.4922-.7344.8164-1.5469.9609-2.3984.3438-1.8281-.082-3.6992-1.1641-5.1797M8.3398 21.1211c-1.8164.4688-3.7109-.2422-4.7734-1.7656-.6523-.8945-.8945-2.0117-.7109-3.1094.0391-.1836.082-.3438.1211-.5273l.1016-.3242.2852.2031c.6719.4844 1.4062.8516 2.2031 1.0977l.2031.0586-.0195.2031c-.0195.2852.0586.5898.2227.832.3281.4688.8984.6914 1.4492.5508.1211-.043.2422-.082.3477-.1445l5.5859-3.5547c.2852-.1836.4688-.4453.5273-.7695.0625-.3281-.0195-.6719-.2031-.9375-.3242-.4648-.8984-.668-1.4492-.5273-.1211.0391-.2422.082-.3438.1406L9.7461 13.9102c-.3477.2227-.7344.3867-1.1445.4883-1.8125.4648-3.707-.2461-4.7695-1.7695-.6328-.8945-.8945-2.0117-.6914-3.1094.1836-1.0547.8359-2.0117 1.7539-2.5781L10.5 3.3867c.3477-.2266.7344-.3867 1.1406-.5078 1.8164-.4688 3.7109.2422 4.7695 1.7656.6523.8945.8984 2.0117.7148 3.1094-.0391.1836-.082.3438-.1406.5273l-.1055.3242-.2852-.2031c-.6719-.4844-1.4063-.8516-2.1992-1.0977l-.2031-.0586.0195-.2031c.0195-.2852-.0625-.5898-.2266-.832-.3242-.4688-.8945-.6719-1.4453-.5313-.125.043-.2461.082-.3477.1445L6.6055 9.3789c-.2852.1836-.4688.4453-.5313.7734-.0586.3242.0234.668.207.9336.3242.4688.8945.6719 1.4453.5273.1211-.0391.2461-.082.3477-.1406l2.1406-1.3633c.3477-.2227.7344-.3867 1.1406-.5078 1.8164-.4648 3.7109.2461 4.7695 1.7695.6523.8945.8984 2.0117.7148 3.1094-.1836 1.0547-.8359 2.0117-1.7539 2.5781L9.4805 20.6133c-.3477.2266-.7344.3867-1.1406.5078"},
    { href: base+'/setup', label: 'Setup', path: "m9.25 22l-.4-3.2q-.325-.125-.612-.3t-.563-.375L4.7 19.375l-2.75-4.75l2.575-1.95Q4.5 12.5 4.5 12.338v-.675q0-.163.025-.338L1.95 9.375l2.75-4.75l2.975 1.25q.275-.2.575-.375t.6-.3l.4-3.2h5.5l.4 3.2q.325.125.613.3t.562.375l2.975-1.25l2.75 4.75l-2.575 1.95q.025.175.025.338v.674q0 .163-.05.338l2.575 1.95l-2.75 4.75l-2.95-1.25q-.275.2-.575.375t-.6.3l-.4 3.2zm2.8-6.5q1.45 0 2.475-1.025T15.55 12t-1.025-2.475T12.05 8.5q-1.475 0-2.488 1.025T8.55 12t1.013 2.475T12.05 15.5" },
    { href: base+'/publish', label: 'Publish', path: "M17 22q-1.25 0-2.125-.875T14 19q0-.15.075-.7L7.05 14.2q-.4.375-.925.588T5 15q-1.25 0-2.125-.875T2 12t.875-2.125T5 9q.6 0 1.125.213t.925.587l7.025-4.1q-.05-.175-.062-.337T14 5q0-1.25.875-2.125T17 2t2.125.875T20 5t-.875 2.125T17 8q-.6 0-1.125-.213T14.95 7.2l-7.025 4.1q.05.175.063.338T8 12t-.012.363t-.063.337l7.025 4.1q.4-.375.925-.587T17 16q1.25 0 2.125.875T20 19t-.875 2.125T17 22"},
    { href: base+'/loading', label: 'Load Data', path: "M12 11q3.75 0 6.375-1.175T21 7t-2.625-2.825T12 3T5.625 4.175T3 7t2.625 2.825T12 11m0 2.5q1.025 0 2.563-.213t2.962-.687t2.45-1.237T21 9.5V12q0 1.1-1.025 1.863t-2.45 1.237t-2.962.688T12 16t-2.562-.213t-2.963-.687t-2.45-1.237T3 12V9.5q0 1.1 1.025 1.863t2.45 1.237t2.963.688T12 13.5m0 5q1.025 0 2.563-.213t2.962-.687t2.45-1.237T21 14.5V17q0 1.1-1.025 1.863t-2.45 1.237t-2.962.688T12 21t-2.562-.213t-2.963-.687t-2.45-1.237T3 17v-2.5q0 1.1 1.025 1.863t2.45 1.237t2.963.688T12 18.5" },
	{ href: base+'/plots', label: 'Basic Plots', path: "M3 21q-.425 0-.712-.288T2 20t.288-.712T3 19h18q.425 0 .713.288T22 20t-.288.713T21 21zm1.5-3q-.625 0-1.062-.437T3 16.5v-4q0-.625.438-1.062T4.5 11t1.063.438T6 12.5v4q0 .625-.437 1.063T4.5 18m5 0q-.625 0-1.062-.437T8 16.5v-9q0-.625.438-1.062T9.5 6t1.063.438T11 7.5v9q0 .625-.437 1.063T9.5 18m5 0q-.625 0-1.062-.437T13 16.5v-6q0-.625.438-1.062T14.5 9t1.063.438T16 10.5v6q0 .625-.437 1.063T14.5 18m5 0q-.625 0-1.062-.437T18 16.5v-12q0-.625.438-1.062T19.5 3t1.063.438T21 4.5v12q0 .625-.437 1.063T19.5 18" },
    { href: base+'/components', label: 'Components', path: "M15 19v-1h-2q-.825 0-1.412-.587T11 16V8H9v1q0 .825-.587 1.413T7 11H4q-.825 0-1.412-.587T2 9V5q0-.825.588-1.412T4 3h3q.825 0 1.413.588T9 5v1h6V5q0-.825.588-1.412T17 3h3q.825 0 1.413.588T22 5v4q0 .825-.587 1.413T20 11h-3q-.825 0-1.412-.587T15 9V8h-2v8h2v-1q0-.825.588-1.412T17 13h3q.825 0 1.413.588T22 15v4q0 .825-.587 1.413T20 21h-3q-.825 0-1.412-.587T15 19M4 5v4zm13 10v4zm0-10v4zm0 4h3V5h-3zm0 10h3v-4h-3zM4 9h3V5H4z" },
    { href: base+'/interaction', label: 'Interaction', path: "M11.71 17.99A5.993 5.993 0 0 1 6 12c0-3.31 2.69-6 6-6c3.22 0 5.84 2.53 5.99 5.71l-2.1-.63a3.999 3.999 0 1 0-4.81 4.81zM22 12c0 .3-.01.6-.04.9l-1.97-.59c.01-.1.01-.21.01-.31c0-4.42-3.58-8-8-8s-8 3.58-8 8s3.58 8 8 8c.1 0 .21 0 .31-.01l.59 1.97c-.3.03-.6.04-.9.04c-5.52 0-10-4.48-10-10S6.48 2 12 2s10 4.48 10 10m-3.77 4.26l2.27-.76c.46-.15.45-.81-.01-.95l-7.6-2.28c-.38-.11-.74.24-.62.62l2.28 7.6c.14.47.8.48.95.01l.76-2.27l3.91 3.91c.2.2.51.2.71 0l1.27-1.27c.2-.2.2-.51 0-.71z" },
    { href: base+'/mapsgraphs', label: 'Maps & Graphs', path: "m20.5 3l-.16.03L15 5.1L9 3L3.36 4.9c-.21.07-.36.25-.36.48V20.5c0 .28.22.5.5.5l.16-.03L9 18.9l6 2.1l5.64-1.9c.21-.07.36-.25.36-.48V3.5c0-.28-.22-.5-.5-.5M15 19l-6-2.11V5l6 2.11z" },
	{ href: base+'/styling', label: 'Style Svelte', path: "m2.53 19.65l1.34.56v-9.03l-2.43 5.86c-.41 1.02.08 2.19 1.09 2.61m19.5-3.7L17.07 3.98a2.01 2.01 0 0 0-1.81-1.23c-.26 0-.53.04-.79.15L7.1 5.95a2 2 0 0 0-1.08 2.6l4.96 11.97a2 2 0 0 0 2.6 1.08l7.36-3.05a1.994 1.994 0 0 0 1.09-2.6M7.88 8.75c-.55 0-1-.45-1-1s.45-1 1-1s1 .45 1 1s-.45 1-1 1m-2 11c0 1.1.9 2 2 2h1.45l-3.45-8.34z"},
    { href: base+'/ml', label: 'Machine Learning', path: "M2 9V5q0-.825.588-1.412T4 3h16q.825 0 1.413.588T22 5v4h-2V5H4v4zm2 9q-.825 0-1.412-.587T2 16v-5h2v5h16v-5h2v5q0 .825-.587 1.413T20 18zm-2 3q-.425 0-.712-.288T1 20t.288-.712T2 19h20q.425 0 .713.288T23 20t-.288.713T22 21zm0-10V9h6q.275 0 .525.15t.375.4l1.175 2.325L13.15 6.5q.125-.225.35-.363T14 6t.525.138t.375.412L16.125 9H22v2h-6.5q-.275 0-.525-.137t-.375-.413l-.65-1.325l-3.075 5.375q-.125.25-.375.375T9.975 15t-.513-.15t-.362-.4L7.375 11z"}
  ];
	$: currentIndex = navItems.findIndex(item => item.href === $page.url.pathname);
</script>

<svelte:head>
  {@html atomOneLight}
</svelte:head>

<div class="container">
	<Sidebar bind:isOpen {navItems}/>
	<div class='content-container {isOpen ? 'open' : 'closed'}'>
		<div class='content'>
			<div class=intermezzo>
				<p>
					With unfortunate timing, <i>Svelte</i> received a major update from <i>version 4</i> to <i>5</i> on the day of our kickoff meeting. 
					While most content in this tutorial still applies, some commands may be <i>deprecated</i>. I am working on it.
				</p>
			</div>
			<slot></slot>
			<div class=nextbuttons>
				{#if currentIndex > 0}
					<a class=button href="{navItems[currentIndex-1].href}">
						<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="currentColor" d="m7.85 13l2.85 2.85q.3.3.288.7t-.288.7q-.3.3-.712.313t-.713-.288L4.7 12.7q-.3-.3-.3-.7t.3-.7l4.575-4.575q.3-.3.713-.287t.712.312q.275.3.288.7t-.288.7L7.85 11H19q.425 0 .713.288T20 12t-.288.713T19 13z"/></svg>
						{navItems[currentIndex-1].label}
					</a>
				{:else}
					<div/>
				{/if}
				{#if currentIndex < navItems.length-1}
					<a class=button href="{navItems[currentIndex+1].href}">
							{navItems[currentIndex+1].label}
							<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="currentColor" d="M16.15 13H5q-.425 0-.712-.288T4 12t.288-.712T5 11h11.15L13.3 8.15q-.3-.3-.288-.7t.288-.7q.3-.3.713-.312t.712.287L19.3 11.3q.15.15.213.325t.062.375t-.062.375t-.213.325l-4.575 4.575q-.3.3-.712.288t-.713-.313q-.275-.3-.288-.7t.288-.7z"/></svg>
					</a>
				{/if}
			</div>
		</div>
	</div>
</div>

<style>
	.content-container {
		padding: 0;
		transition: margin-left 0.3s ease;
		background-color: var(--background-color);
		color: var(--text-color);
	}

	.content-container.open {
		margin-left: var(--sidebar-width);
	}

	.content-container.closed {
		margin-left: 0;
	}

	@media (max-width: 1280px) {
		.content-container.open {
			margin-left: 0px;
		}
	}

	.content {
		max-width: var(--max-width);
		margin: 0 auto;
	}

	.nextbuttons {
		display: flex; 
		justify-content: space-between; 
		margin-top: 1rem;
	}
</style>